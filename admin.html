<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Painel Admin - Vmuka</title>
<style>
body{
  font-family: Arial;
  background:#111;
  color:white;
  padding:20px;
}
.card{
  background:#222;
  padding:15px;
  margin-bottom:15px;
  border-radius:10px;
}
button{
  padding:8px 12px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  margin-top:10px;
}
.liberar{
  background:#00cfff;
}
.limpar{
  background:red;
  color:white;
}
</style>
</head>

<body>

<h2>ðŸ’Ž Painel Administrativo</h2>

<div id="lista"></div>

<button class="limpar" onclick="limparTudo()">Limpar Todos Agendamentos</button>

<script>

function carregar() {
  const listaDiv = document.getElementById("lista");
  const agendamentos = JSON.parse(localStorage.getItem("agendamentos")) || [];

  listaDiv.innerHTML = "";

  agendamentos.forEach((ag, index) => {

    listaDiv.innerHTML += `
      <div class="card">
        <b>${ag.nome}</b><br>
        ${ag.dia} - ${ag.horario}<br>
        <button class="liberar" onclick="liberar(${index})">
          Liberar HorÃ¡rio
        </button>
      </div>
    `;
  });
}function gerarLinkGoogle(dia, horario, nome){

  const dataBase = new Date();
  const diasSemana = {
    "Segunda-feira":1,
    "TerÃ§a-feira":2,
    "Quarta-feira":3,
    "Quinta-feira":4,
    "Sexta-feira":5,
    "SÃ¡bado":6
  };

  const hoje = dataBase.getDay();
  const alvo = diasSemana[dia];

  let diff = alvo - hoje;
  if(diff < 0) diff += 7;

  dataBase.setDate(dataBase.getDate()+diff);

  const [hora, minuto] = horario.split(":");

  dataBase.setHours(hora);
  dataBase.setMinutes(minuto);

  const inicio = dataBase.toISOString().replace(/-|:|\.\d+/g,"");
  dataBase.setHours(dataBase.getHours()+2);
  const fim = dataBase.toISOString().replace(/-|:|\.\d+/g,"");

  return `https://www.google.com/calendar/render?action=TEMPLATE&text=Agendamento Vmuka-Car - ${nome}&dates=${inicio}/${fim}&details=ServiÃ§o agendado via app&sf=true&output=xml`;
}


function liberar(index){
  let agendamentos = JSON.parse(localStorage.getItem("agendamentos")) || [];
  agendamentos.splice(index,1);
  localStorage.setItem("agendamentos", JSON.stringify(agendamentos));
  carregar();
}

function limparTudo(){
  localStorage.removeItem("agendamentos");
  carregar();
}

carregar();

</script>

</body>
</html>
